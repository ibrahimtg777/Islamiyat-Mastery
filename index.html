<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CAIE Notes Vault — Single HTML File</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .note-content { white-space: pre-wrap; line-height: 1.6; }
    /* Small responsive tweaks */
    @media (min-width: 640px) {
      .grid-cols-responsive { grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (min-width: 1024px) {
      .grid-cols-responsive { grid-template-columns: repeat(3, minmax(0,1fr)); }
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col">
  <header class="bg-gradient-to-r from-sky-600 to-indigo-600 text-white p-6">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
      <h1 class="text-2xl font-bold">CAIE Notes Vault — HTML</h1>
      <div class="flex gap-3">
        <button id="unlockAllBtn" class="bg-white text-indigo-600 px-3 py-1 rounded shadow-sm">Unlock All</button>
        <button id="exportAllBtn" class="bg-white text-indigo-600 px-3 py-1 rounded shadow-sm">Download All</button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-6 flex-1 w-full">
    <section class="mb-6">
      <p class="text-slate-700">Single-file HTML app with original CAIE-style notes. Payment is simulated locally — unlocking is stored in your browser only. Use <strong>Download</strong> to save notes as text files.</p>
    </section>

    <section id="subjectsGrid" class="grid gap-4 grid-cols-responsive mb-8">
      <!-- Cards inserted by JS -->
    </section>

    <section id="noteView" class="hidden">
      <div class="bg-white p-6 rounded shadow">
        <div class="flex justify-between items-start">
          <h2 id="noteTitle" class="text-2xl font-bold"></h2>
          <div class="space-x-2">
            <button id="downloadBtn" class="px-3 py-1 border rounded">Download .txt</button>
            <button id="printBtn" class="px-3 py-1 border rounded">Print</button>
            <button id="backBtn" class="px-3 py-1 border rounded">Back</button>
          </div>
        </div>
        <div class="mt-4 note-content text-slate-800" id="noteContent"></div>
      </div>
    </section>
  </main>

  <footer class="text-center p-6 text-sm text-slate-600">
    © <span id="year"></span> CAIE Notes Vault — Original educational notes (not official Cambridge materials).
  </footer>

  <script>
    // ---------- Data (original notes) ----------
    const NOTES = {
      "mathematics": {
        title: "Mathematics (IGCSE / AS-A Level core concepts)",
        price: 4.99,
        content:
`Mathematics — Comprehensive Study Notes

1. Number System & Arithmetic
- Real numbers: integers, rationals, irrationals, decimals and surds. Rationalize denominators; simplify surds using prime factorization.
- Indices (exponents): laws of indices (product, quotient, negative and fractional indices). Use index rules to simplify algebraic expressions.
- Standard form/Scientific notation: express numbers as a × 10^n where 1 ≤ a < 10; useful for significant figures.

2. Algebra
- Simplifying expressions, factorisation, completing the square.
- Solving linear, quadratic and simultaneous equations.
- Inequalities, functions, sequences (arithmetic & geometric).

3. Coordinate Geometry & Graphs
- Equation of a line: y = mx + c; circles and parabolas; transformations.

4. Trigonometry
- sin, cos, tan, radian measure, small-angle approximations, sine & cosine rules.

5. Calculus (AS/A-level core)
- Limits, differentiation (power, product, chain rules), integration, applications to kinematics and areas.

6. Geometry & Vectors
- Euclidean proofs, vector addition and dot product.

7. Probability & Statistics
- Basic probability rules, permutations/combinations, mean/median/mode, standard deviation.

Formulas Quick Reference:
- Quadratic formula: x = [-b ± sqrt(b^2 - 4ac)]/(2a)
- Area triangle: 0.5 × base × height
- Differentiation: d/dx[x^n] = n x^(n-1)`
      },
      "physics": {
        title: "Physics (IGCSE / AS-A Level core concepts)",
        price: 4.99,
        content:
`Physics — Comprehensive Study Notes

1. Mechanics
- Kinematics: velocity, acceleration, SUVAT equations.
- Forces & Newton's laws: free-body diagrams, F = ma.
- Energy & momentum: conservation laws, KE = 1/2 mv^2.

2. Materials & Properties
- Stress, strain, Young's modulus, Hooke's law.

3. Waves & Optics
- Wave properties, sound, refraction (Snell's law), lenses.

4. Electricity & Magnetism
- Current, voltage, resistance (Ohm's law), circuits, P = VI.
- Electromagnetism basics and Faraday's law.

5. Thermal Physics
- Specific heat, latent heat, ideal gas approximations.

6. Modern Physics
- Photoelectric effect, radioactivity basics.

Practical & Measurement:
- SI units, uncertainty handling and significant figures.`
      },
      "chemistry": {
        title: "Chemistry (IGCSE / AS-A Level core concepts)",
        price: 4.99,
        content:
`Chemistry — Comprehensive Study Notes

1. Atomic Structure & Periodic Trends
- Atoms, isotopes, electronic configurations, periodic trends.

2. Bonding & Structure
- Ionic, covalent, metallic bonding; intermolecular forces and physical properties.

3. Stoichiometry
- Mole concept, molar mass, reacting masses, concentration and titration calculations.

4. Energetics
- Exothermic/endothermic, Hess's law, energy profiles.

5. Rates & Equilibrium
- Collision theory, rate laws, Le Chatelier's principle.

6. Acids/Bases & Organic Chemistry
- pH, neutralisation, redox basics, functional groups and common reactions.`
      },
      "biology": {
        title: "Biology (IGCSE / AS-A Level core concepts)",
        price: 4.99,
        content:
`Biology — Comprehensive Study Notes

1. Cell Biology
- Cell structure (organelles), membrane transport, respiration and photosynthesis basics.

2. Genetics
- DNA structure, transcription/translation, mitosis & meiosis, inheritance patterns.

3. Physiology & Homeostasis
- Plant transport, human circulatory and respiratory systems, hormones and nervous coordination.

4. Ecology & Evolution
- Ecosystems, food webs, natural selection, speciation.

5. Microbiology & Immunology
- Types of microorganisms, immune response basics, vaccines.

Practical Skills:
- Microscopy, experimental design, data interpretation.`
      },
      "english": {
        title: "English Language (IGCSE) — Reading & Writing Skills",
        price: 4.99,
        content:
`English Language — Comprehensive Study Notes

1. Reading Skills
- Active reading: main idea, tone, purpose. Language features and inference.

2. Writing Skills
- Planning, paragraph structure, tone & register, persuasive and descriptive techniques.

3. Grammar & Sentence Structure
- Sentence variety, punctuation, common error correction.

4. Summary & Note-Making
- Condensing information, using headings and bullet points.

Exam Tips:
- Annotate texts, use short quotes with explanation, plan essays.`
      },
      "economics": {
        title: "Economics (IGCSE / AS Intro)",
        price: 4.99,
        content:
`Economics — Comprehensive Study Notes

1. Basic Economic Problem & PPF
- Scarcity, choice, opportunity cost, production possibility frontier.

2. Demand & Supply
- Determinants, elasticity, equilibrium, shifts vs movements.

3. Market Structures & Failure
- Types of markets, externalities and government intervention.

4. Macroeconomics Basics
- AD components, inflation, unemployment, fiscal and monetary policy.

5. International Trade & Development
- Comparative advantage, trade benefits, development indicators.`
      },
      "history": {
        title: "History (Modern World themes) — Study Notes",
        price: 4.99,
        content:
`History — Comprehensive Study Notes

1. Causes of Conflict & World Wars
- Nationalism, imperial rivalry, militarism, alliances; features and consequences of 20th-century wars.

2. Interwar Years & Rise of Extremism
- Economic causes, political instability, case studies (fascism, Nazism).

3. Cold War
- Ideological struggle, proxy wars, key crises (Berlin, Cuba, Korea, Vietnam).

4. Decolonisation & Development
- Independence movements, post-colonial challenges.

Exam Tips:
- Use dates and specific examples; practice source analysis and causation essays.`
      }
    };

    // ---------- Storage helpers ----------
    const STORAGE_KEY = 'caie_html_unlocked_v1';
    function loadUnlocked() {
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }
      catch { return []; }
    }
    function saveUnlocked(list) { localStorage.setItem(STORAGE_KEY, JSON.stringify(list)); }
    function isUnlocked(k) { return loadUnlocked().includes(k); }
    function unlock(k) {
      const arr = loadUnlocked();
      if (!arr.includes(k)) { arr.push(k); saveUnlocked(arr); }
    }
    function unlockAll() { saveUnlocked(Object.keys(NOTES)); }
    function lockAll() { saveUnlocked([]); }

    // ---------- DOM references ----------
    const subjectsGrid = document.getElementById('subjectsGrid');
    const noteView = document.getElementById('noteView');
    const noteTitle = document.getElementById('noteTitle');
    const noteContent = document.getElementById('noteContent');
    const backBtn = document.getElementById('backBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const printBtn = document.getElementById('printBtn');
    const unlockAllBtn = document.getElementById('unlockAllBtn');
    const exportAllBtn = document.getElementById('exportAllBtn');
    document.getElementById('year').innerText = new Date().getFullYear();

    // ---------- Render ----------
    function createCard(key, data) {
      const unlocked = isUnlocked(key);
      const container = document.createElement('div');
      container.className = 'p-4 bg-white rounded shadow';
      container.innerHTML = `
        <h3 class="font-bold text-lg">${data.title}</h3>
        <p class="text-sm text-slate-600 mt-1">Price: $${data.price.toFixed(2)} (demo)</p>
        <div class="mt-4 flex gap-2">
          <button data-key="${key}" class="viewBtn px-3 py-1 border rounded">${unlocked ? 'View notes' : 'Preview'}</button>
          ${unlocked ? `<button data-key="${key}" class="downloadBtn px-3 py-1 border rounded">Download</button>` : `<button data-key="${key}" class="buyBtn px-3 py-1 bg-indigo-600 text-white rounded">Buy $${data.price.toFixed(2)}</button>`}
        </div>
      `;
      return container;
    }

    function renderGrid() {
      subjectsGrid.innerHTML = '';
      for (const [key, data] of Object.entries(NOTES)) {
        subjectsGrid.appendChild(createCard(key, data));
      }
      // events
      document.querySelectorAll('.viewBtn').forEach(b => b.onclick = (e) => {
        const k = e.currentTarget.dataset.key;
        if (isUnlocked(k)) showNote(k); else showPreview(k);
      });
      document.querySelectorAll('.buyBtn').forEach(b => b.onclick = (e) => {
        const k = e.currentTarget.dataset.key;
        if (confirm(`Simulated purchase for "${NOTES[k].title}". Click OK to unlock.`)) {
          unlock(k); alert('Unlocked (demo).'); renderGrid();
        }
      });
      document.querySelectorAll('.downloadBtn').forEach(b => b.onclick = (e) => {
        const k = e.currentTarget.dataset.key;
        downloadText(`${NOTES[k].title}.txt`, `${NOTES[k].title}\n\n${NOTES[k].content}`);
      });
    }

    function showPreview(k) {
      const data = NOTES[k];
      noteTitle.textContent = data.title + ' — Preview';
      noteContent.textContent = data.content.slice(0, 900) + (data.content.length > 900 ? '\n\n[...preview — purchase to read full notes]' : '');
      noteView.classList.remove('hidden');
      // attach buy prompt under content
      const buyBtn = document.createElement('button');
      buyBtn.className = 'mt-4 px-3 py-1 bg-indigo-600 text-white rounded';
      buyBtn.textContent = `Buy $${data.price.toFixed(2)}`;
      buyBtn.onclick = () => {
        if (confirm(`Simulated purchase for "${data.title}". Click OK to unlock.`)) {
          unlock(k); alert('Unlocked.'); renderGrid(); showNote(k);
        }
      };
      noteContent.parentElement.appendChild(buyBtn);
    }

    function showNote(k) {
      const data = NOTES[k];
      noteTitle.textContent = data.title;
      noteContent.textContent = data.content;
      noteView.classList.remove('hidden');
      downloadBtn.onclick = () => downloadText(`${data.title}.txt`, `${data.title}\n\n${data.content}`);
    }

    backBtn.onclick = () => {
      noteView.classList.add('hidden');
      // remove any buy buttons appended
      const appended = noteContent.parentElement.querySelector('button.mt-4');
      if (appended) appended.remove();
    };
    printBtn.onclick = () => window.print();

    unlockAllBtn.onclick = () => {
      if (confirm('Simulated unlock all subjects? This stores unlocked state in your browser only.')) {
        unlockAll(); alert('All unlocked (demo).'); renderGrid();
      }
    };

    exportAllBtn.onclick = () => {
      let combined = '';
      for (const d of Object.values(NOTES)) {
        combined += `=== ${d.title} ===\n\n${d.content}\n\n\n`;
      }
      downloadText('CAIE_All_Notes.txt', combined);
    };

    function downloadText(filename, text) {
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // init
    renderGrid();
    if (!localStorage.getItem('caie_seen_welcome_html')) {
      alert('Welcome — this file contains original CAIE-style study notes. Purchases are simulated locally. Use Download to save notes as .txt.');
      localStorage.setItem('caie_seen_welcome_html', '1');
    }

    // quick lock keyboard shortcut: Shift+L
    window.addEventListener('keydown', (e) => {
      if (e.shiftKey && e.key.toLowerCase() === 'l') {
        if (confirm('Clear all unlocked subjects?')) { lockAll(); renderGrid(); alert('All locked.'); }
      }
    });
  </script>
</body>
</html>
